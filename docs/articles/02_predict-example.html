<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prediction with BCF • bcf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prediction with BCF">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bcf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_simple-example.html">A Simple Example</a>
    </li>
    <li>
      <a href="../articles/02_predict-example.html">Prediction with BCF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Prediction with BCF</h1>
            
      
      
      <div class="hidden name"><code>02_predict-example.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we show how to use the <code>bcf</code> package to fit a model and use the fitted object to predict estimates for new data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bcf)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(latex2exp)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span></code></pre></div>
<p>To fit the model to simulated data, we follow the same process as in the “Simple Example” vignette. For that reason, we do not show the data generation and model fitting steps here.</p>
<div id="predicting-using-bcf" class="section level2">
<h2 class="hasAnchor">
<a href="#predicting-using-bcf" class="anchor"></a>Predicting using BCF</h2>
<p>We now use a separate set of covariate values for prediction. First, we generate a testing dataset. We make sure to include some values outside the range of our training dataset, to allow us to gauge out-of-sample error.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">## Testing data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>n_test =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>x_test  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n_test<span class="op">*</span>p), <span class="dt">nrow=</span>n_test)</span>
<span id="cb2-5"><a href="#cb2-5"></a>special_x3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">4</span>, <span class="fl">-3.7</span>, <span class="fl">3.3</span>, <span class="fl">3.5</span>, <span class="fl">3.7</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>x_test[ (n_test <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(special_x3) <span class="op">+</span><span class="st"> </span><span class="dv">1</span> )<span class="op">:</span>n_test,<span class="dv">3</span>] &lt;-<span class="st"> </span>special_x3 <span class="co"># including some X3s outside of range</span></span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>mu_pred  &lt;-<span class="st"> </span><span class="dv">-1</span><span class="op">*</span>(x_test[,<span class="dv">1</span>]<span class="op">&gt;</span>(x_test[,<span class="dv">2</span>])) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">*</span>(x_test[,<span class="dv">1</span>]<span class="op">&lt;</span>(x_test[,<span class="dv">2</span>])) <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>pi_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(mu_pred)</span>
<span id="cb2-10"><a href="#cb2-10"></a>z_pred  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(n_test,<span class="dv">1</span>, pi_pred)</span></code></pre></div>
<p>We now use these data to generate predictions based on our model.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>pred_out =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="dt">bcfObj=</span>bcf_out,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                   <span class="dt">x_predict_control=</span>x_test,</span>
<span id="cb3-3"><a href="#cb3-3"></a>                   <span class="dt">x_predict_moderate=</span>x_test,</span>
<span id="cb3-4"><a href="#cb3-4"></a>                   <span class="dt">pi_pred=</span>pi_pred,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                   <span class="dt">z_pred=</span>z_pred,</span>
<span id="cb3-6"><a href="#cb3-6"></a>                   <span class="dt">save_tree_directory =</span> <span class="st">'..'</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; Initializing BCF Prediction</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; Starting Prediction</span></span></code></pre></div>
</div>
<div id="comparison" class="section level2">
<h2 class="hasAnchor">
<a href="#comparison" class="anchor"></a>Comparison</h2>
<p>Let’s compare the results for our training and testing data. We will show the estimated treatment effects for training and test observations as a function of <span class="math inline">\(x_3\)</span>, which is an effect modifier.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>lower &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(bcf_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>), <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>))</span>
<span id="cb4-2"><a href="#cb4-2"></a>upper &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(bcf_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>), <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_out<span class="op">$</span>tau, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>))</span>
<span id="cb4-3"><a href="#cb4-3"></a>group &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"training"</span>, n), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"testing"</span>, n_test)))</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">ggplot</span>(<span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(x[,<span class="dv">3</span>], x_test[,<span class="dv">3</span>]), </span>
<span id="cb4-6"><a href="#cb4-6"></a>                 <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(bcf_out<span class="op">$</span>tau), <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(pred_out<span class="op">$</span>tau)),</span>
<span id="cb4-7"><a href="#cb4-7"></a>                 <span class="dt">alpha =</span> group,</span>
<span id="cb4-8"><a href="#cb4-8"></a>                 <span class="dt">color =</span> group)) <span class="op">+</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper)) <span class="op">+</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="st">  </span><span class="kw">scale_alpha_discrete</span>(<span class="dt">range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.0</span>, <span class="fl">0.3</span>)) <span class="op">+</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">TeX</span>(<span class="st">"$x_3$"</span>)) <span class="op">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">TeX</span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">hat{</span><span class="ch">\\</span><span class="st">tau}$"</span>)) <span class="op">+</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="st">  </span><span class="kw">coord_flip</span>()</span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="02_predict-example_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The estimates for testing observations have treatment effects well within the range of the treatment effects for training observations, even though the test data set contains more extreme values of <span class="math inline">\(x_3\)</span>. It is reassuring that these observations’ treatment effect estimates still fall within the expected range, suggesting that this model is not overly vulnerable to out-of-sample prediction error.</p>
</div>
<div id="marginal-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-effects" class="anchor"></a>Marginal effects</h2>
<p>We can use <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> to compute mean marginal effects, in other words the effect of a given covariate averaged across the levels of all other covariates (which corresponds to an estimate from a standard parametric regression). We provide an example using subgroups discussed in the “Simple Example” vignette. Specifically, we compare the mean marginal effects for the average value of <span class="math inline">\(x_3\)</span> in the bottom quartile and the average value of <span class="math inline">\(x_3\)</span> in the top quartile.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Computing the average X3 values in Q1 and Q4 for prediction</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>q1Bar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(x[,<span class="dv">3</span>][x[,<span class="dv">3</span>] <span class="op">&lt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(x[,<span class="dv">3</span>], <span class="fl">0.25</span>)])</span>
<span id="cb5-3"><a href="#cb5-3"></a>q4Bar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(x[,<span class="dv">3</span>][x[,<span class="dv">3</span>] <span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(x[,<span class="dv">3</span>], <span class="fl">0.75</span>)])</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Creating training datasets with new X3 values</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>x_low &lt;-<span class="st"> </span>x; x_high &lt;-<span class="st"> </span>x</span>
<span id="cb5-7"><a href="#cb5-7"></a>x_low[,<span class="dv">3</span>]  &lt;-<span class="st"> </span>q1Bar </span>
<span id="cb5-8"><a href="#cb5-8"></a>x_high[,<span class="dv">3</span>] &lt;-<span class="st"> </span>q4Bar</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>pred_low =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="dt">bcfObj=</span>bcf_out,</span>
<span id="cb5-11"><a href="#cb5-11"></a>                   <span class="dt">x_predict_control=</span>x_low,</span>
<span id="cb5-12"><a href="#cb5-12"></a>                   <span class="dt">x_predict_moderate=</span>x_low,</span>
<span id="cb5-13"><a href="#cb5-13"></a>                   <span class="dt">pi_pred=</span>pi,</span>
<span id="cb5-14"><a href="#cb5-14"></a>                   <span class="dt">z_pred=</span>z,</span>
<span id="cb5-15"><a href="#cb5-15"></a>                   <span class="dt">save_tree_directory =</span> <span class="st">'..'</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; Initializing BCF Prediction</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt; Starting Prediction</span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a>pred_high =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="dt">bcfObj=</span>bcf_out,</span>
<span id="cb5-20"><a href="#cb5-20"></a>                    <span class="dt">x_predict_control=</span>x_high,</span>
<span id="cb5-21"><a href="#cb5-21"></a>                    <span class="dt">x_predict_moderate=</span>x_high,</span>
<span id="cb5-22"><a href="#cb5-22"></a>                    <span class="dt">pi_pred=</span>pi,</span>
<span id="cb5-23"><a href="#cb5-23"></a>                    <span class="dt">z_pred=</span>z,</span>
<span id="cb5-24"><a href="#cb5-24"></a>                    <span class="dt">save_tree_directory =</span> <span class="st">'..'</span>)</span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#&gt; Initializing BCF Prediction</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">#&gt; Starting Prediction</span></span></code></pre></div>
<p>Now that we have our predictions, we look at the posterior distribution of the mean marginal treatment effect for each group.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Computing weighted means to get distribution of posterior average estimates</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>lowDist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_low<span class="op">$</span>tau, <span class="dv">1</span>, weighted.mean, weights)</span>
<span id="cb6-3"><a href="#cb6-3"></a>highDist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(pred_high<span class="op">$</span>tau, <span class="dv">1</span>, weighted.mean, weights)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>distDF &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">taus  =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lowDist, highDist),</span>
<span id="cb6-6"><a href="#cb6-6"></a>                     <span class="dt">Group =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"X3 = "</span>, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(q1Bar, <span class="dv">1</span>)), <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(lowDist)), <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"X3 = "</span>, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(q4Bar, <span class="dv">1</span>)), <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(highDist)))))</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">ggplot</span>(distDF, <span class="kw">aes</span>(taus, <span class="dt">group =</span> Group, <span class="dt">color =</span> Group, <span class="dt">fill =</span> Group)) <span class="op">+</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">TeX</span>(<span class="st">"$</span><span class="ch">\\</span><span class="st">tau$"</span>))</span></code></pre></div>
<p><img src="02_predict-example_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>We see that the posterior distributions of the mean marginal treatment effect for the two groups barely overlap. We can confirm this by computing the probability that the mean marginal treatment effect for the top units (<span class="math inline">\(x_3 =\)</span> 1.3) is greater than the mean marginal treatment effect for the bottom units ((<span class="math inline">\(x_3 =\)</span> -1.3)).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(highDist <span class="op">&gt;</span><span class="st"> </span>lowDist)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>We found that there is a 100 percent probability that the mean marginal treatment effect for top-quartile units is greater than that for bottom-quartile units.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#predicting-using-bcf">Predicting using BCF</a></li>
      <li><a href="#comparison">Comparison</a></li>
      <li><a href="#marginal-effects">Marginal effects</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jared S. Murray, P. Richard Hahn, Carlos Carvalho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
